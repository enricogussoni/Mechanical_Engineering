clear all
clc

%% Alternate
distance_w_al=[0
2.99432
7.75153
13.3229
19.0684
24.9504
30.9308
36.9703
42.9825
45.9649
48.9474
51.9298
54.9123
57.8947
60.8772
63.8596
66.8421
69.8246
72.807
75.7895
78.7719
81.7544
84.7368
87.7193
90.7018];

S11_w_al_max=108.81;

Mises_w_al=[64.0581
69.6181
87.6527
91.5811
95.3181
98.4261
99.5866
97.2739
91.7076
89.6767
88.3911
87.533
86.9094
86.4931
86.1711
85.9213
85.7494
85.6385
85.5505
85.4357
85.2969
85.1972
85.1149
85.0831
85.0829];

distance_wb_al=[0
2.99432
5.19403
7.75153
10.5131
13.3229
16.1761
19.0684
21.9947
27.9308
33.9456
40
42.9825
45.9649
48.9474
51.9298
54.9123
57.8947
60.8772
63.8596
66.8421
69.8246
72.807
75.7895
78.7719
81.7544
84.7368
87.7193
90.7018
93.6842];

Mises_wb_al=[73.5644
79.7122
88.7704
100.73
103.91
105.596
107.96
110.21
112.455
115.246
115.175
110.179
106.952
104.671
103.252
102.326
101.671
101.255
100.947
100.721
100.585
100.519
100.479
100.406
100.303
100.244
100.205
100.223
100.277
100.325];

%% Medium
distance_shrink=[0
0.942657
2.23892
3.85437
5.73093
7.83057
10.5786
13.3741
16.2126
19.0895
22.0002
24.9399
27.904
30.8876
33.886
36.8942
39.9074
47.6346
55.3619
63.0892
70.8165
78.5437
86.271
93.9983];

S11_shrink=[-116.999
-93.3241
-57.7718
-35.7029
-16.4698
-9.90913
-3.29377
0.216794
0.607618
0.85088
0.297956
0.97425
0.651108
0.183219
-0.00563532
-0.502276
0.277351
0.124714
-0.0724254
-0.0565653
-0.135452
-0.00820811
-0.179684
-0.0442809];

S22_shrink=[-30.6678
-22.9763
-16.3585
-12.6593
-6.32114
-0.560406
4.96982
10.3147
14.0666
17.4365
19.8661
21.6729
23.7991
26.1079
27.5345
26.2534
23.5635
20.4835
17.1577
14.2045
11.3763
8.84045
6.55043
4.23822];

S33_shrink=[-89.732
-78.9436
-63.5096
-52.8297
-41.2842
-34.6946
-27.6443
-22.0828
-18.2868
-14.2697
-11.0808
-8.34298
-5.46586
-2.65182
-0.819317
-0.249737
0.650739
1.90226
2.95191
3.59893
3.83894
3.92804
3.77362
3.55512];

distance_wb_med=[0
2.99432
5.19403
7.75153
10.5131
13.3229
16.1761
19.0684
21.9947
27.9308
33.9456
40
42.9825
45.9649
48.9474
51.9298
54.9123
57.8947
60.8772
63.8596
66.8421
69.8246
72.807
75.7895
78.7719
81.7544
84.7368
87.7193
90.7018
93.6842];

S11_wb_med=[-0.461916
-1.20083
-1.23686
-0.961726
-0.699274
-0.547244
-0.431147
-0.344228
-0.263856
-0.150999
-0.0769208
-0.024635
-0.00916193
-0.0024173
-0.000902405
0.000311427
0.000233535
0.000631779
0.00068554
0.000855293
0.000518597
0.000488929
0.000227165
0.000415475
0.000133326
0.000382248
2.61164E-005
0.000102807
-0.000121995
-0.000169823];

S22_wb_med=[-0.757326
-1.97204
-2.55079
-2.97968
-3.08416
-3.13247
-3.18451
-3.23071
-3.26424
-3.27006
-3.16274
-2.89069
-2.74021
-2.62789
-2.54792
-2.48675
-2.43819
-2.399
-2.36751
-2.34193
-2.32051
-2.30236
-2.28734
-2.27537
-2.26605
-2.25879
-2.25289
-2.24797
-2.24397
-2.24072];

S33_wb_med=[-0.364987
-0.969034
-1.1489
-1.16622
-1.08713
-1.02359
-0.972204
-0.92786
-0.881568
-0.784738
-0.665017
-0.503261
-0.423544
-0.360244
-0.310505
-0.268514
-0.232384
-0.200516
-0.17264
-0.147912
-0.125793
-0.105673
-0.087671
-0.0715455
-0.0573904
-0.0446316
-0.0333624
-0.0231111
-0.0140463
-0.00590298];

distance_w_med=[0
2.99432
7.75153
13.3229
19.0684
24.9504
30.9308
36.9703
42.9825
45.9649
48.9474
51.9298
54.9123
57.8947
60.8772
63.8596
66.8421
69.8246
72.807
75.7895
78.7719
81.7544
84.7368
87.7193
90.7018];

S11_w_med=[-0.45925
-1.19571
-0.965033
-0.555815
-0.354879
-0.216204
-0.121596
-0.0614134
-0.016861
-0.00907259
-0.0066617
-0.00470697
-0.00410266
-0.00313658
-0.00256229
-0.00195471
-0.00185725
-0.00154692
-0.00145499
-0.000983076
-0.00101536
-0.000503225
-0.000672096
-0.000412285
-0.000448617];

S22_w_med=[-0.757062
-1.97103
-2.97819
-3.13086
-3.22906
-3.27702
-3.23233
-3.0452
-2.73993
-2.62794
-2.54832
-2.48755
-2.43944
-2.40076
-2.36982
-2.34487
-2.32416
-2.30682
-2.29271
-2.28175
-2.27352
-2.26743
-2.26279
-2.25925
-2.25677];

S33_w_med=[-0.366441
-0.972803
-1.16201
-1.01456
-0.917047
-0.824398
-0.71811
-0.580903
-0.417505
-0.355539
-0.306996
-0.266083
-0.23097
-0.200062
-0.173096
-0.149249
-0.127997
-0.108741
-0.0915954
-0.0763253
-0.0630188
-0.0510841
-0.0406563
-0.0312285
-0.0230021];

invariance_shrink=S11_shrink+S22_shrink+S33_shrink;
invariance_wb_med=S11_wb_med+S22_wb_med+S33_wb_med;
invariance_w_med=S11_w_med+S22_w_med+S33_w_med;

figure();
hold on;
plot(distance_w_al,Mises_w_al);
plot(distance_w_med,invariance_w_med,'--');
plot(distance_wb_al,Mises_wb_al,'r');
plot(distance_wb_med,invariance_wb_med,'r--');
plot(distance_shrink,invariance_shrink,'g');
xlabel('Y coordinate along axis');
ylabel('Stress [MPa]');
legend('Von Mises alternate (only weight/lateral acc)','First invariant (only weight/lateral acc)','Von Mises alternate (weight/lateral acc + brake forces)','First invariant (weight/lateral acc + brake forces)','First invariant (only shrinkfit)');

%% FATIGUE ASSESMENT
sigma_u=600;
sigma_e=200;

sines_eq_w=Mises_w_al./(1-invariance_w_med/sigma_u);
sines_eq_wb=Mises_wb_al./(1-invariance_wb_med/sigma_u);

eta_w=sigma_e./sines_eq_w;
eta_wb=sigma_e./sines_eq_wb;

figure();
hold on;
plot(distance_w_al,eta_w);
plot(distance_wb_al,eta_wb,'r');

xlabel('Y coordinate along axis');
ylabel('Safety Factor');
legend('Only weight/lateral acc','Weight/lateral acc + brake');

% Kt
sigma_max_analitical = 93.53; % [MPa] from previous calculations

Kt = (S11_w_al_max)/sigma_max_analitical

Max_shrink=max(invariance_shrink)